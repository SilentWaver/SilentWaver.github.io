---
title: TCP带外数据传输
date: 2020-1-1
tags:
  - 网络
categories: []
---
 


今天复习网络程序设计，里面提到了TCP的带外数据传输是由TCP报文的urg位和紧急指针实现的。但是书上说紧急指针指向的是紧急字段的下一字节。这与我之前复习计算机网络时，书上的描述不符。于是我找了几篇博文看了看，直接给我看蒙了。

<!-- more -->

以下是我找到的一种简单易懂的tcp-oob传输的解释。

> 1. 紧急数据是插在正常数据流中进行传输的 。
> 2. 一个紧急指针**只指向一个字节的带外数据的后一个字节位置**。比如我们要发送数据1，2，3，4，5，6 ，7，8，如果我们只发送一个字节的带外数据X，那么发送缓冲区就是（1，2，3，4，5，6，7，8，X），紧急指针置为10，X是带外数据字节 。如果我们发送多个字节的带外数据（X，Y，Z），那么发送缓冲区就是（1，2，3，4，5，6，7，8，X，Y，Z），紧急指针指向Z的后面，为12 ，Z 被当作带外数据字节。
> 3. 假如由于发送窗口的关系，导致该发送缓冲区中的数据（1，2，3，4，5，6，7，8，X）分为多次或者两次发送。比如：发送窗口是`6`，那么就分为两个包发送，情况如下：第一个包紧急指针为10，传送六个字节（1,2,3,4,5,6），**接收端记下接受的字节数并且发现紧急指针指向的紧急数据没有到达**，所以继续等待下一个包，下一个包（紧急指针还是10）发过来 7,8,X ，接收端发现紧急指针指向的紧急数据在这个包里，所以将紧急数据进行处理即可。

我的疑点在于，在《数据通信与网络》这本书里，紧急指针指向紧急数据的末尾，紧急数据置于报文数据段的开始位置。而到了这里，变成了只能传输一字节的紧急数据，且指针指向紧急字节的下一字节，和《网络程序设计》这本书描述符合。

在翻阅更多文章后，我找到了原因。这是由于TCP对紧急数据的处理有两种解释造成的。TCP紧急指针有两种解释， **RFC793解释**和 **BSD解释** 。RFC793为最开始的标准。但绝大部分的实现却都基于BSD解释。这其中的原因我暂且蒙在鼓里（

也就是说，计网里的是RFC793解释，而网络程序设计里则是BSD解释。可能是因为计网偏理论，程序设计偏实践的关系吧。

以下是BSD和RFC的相关信息

>  BSD ([Berkeley](https://baike.baidu.com/item/Berkeley) [Software](https://baike.baidu.com/item/Software) [Distribution](https://baike.baidu.com/item/Distribution)，[伯克利](https://baike.baidu.com/item/伯克利/25375)软件套件)是[Unix](https://baike.baidu.com/item/Unix/219943)的衍生系统，在1977至1995年间由[加州大学伯克利分校](https://baike.baidu.com/item/加州大学伯克利分校/3755024)开发和发布的。历史上， BSD曾经被认为是[UNIX](https://baike.baidu.com/item/UNIX)的一支——"BSD UNIX", 因为它和[AT&T](https://baike.baidu.com/item/AT%26T) UNIX操作系统共享基础代码和设计。在20世纪80年代，衍生出了许多变形的UNIX授权软件。比较著名的如[DEC](https://baike.baidu.com/item/DEC)的Ultrix及Sun公司的[SunOS](https://baike.baidu.com/item/SunOS)。1990年代，BSD很大程度上被System V4.x版以及OSF/1系统所取代，晚期BSD版本为几个开源软件开发提供了平台并且一直沿用至今。今天，“BSD”并不特指任何一个BSD衍生版本，而是类UNIX操作系统中的一个分支的总称。 
>
>  BSD[开源协议](https://baike.baidu.com/item/开源协议/10642383)是一个给予[使用](https://baike.baidu.com/item/使用)者很大自由的协议。基本上使用者可以"为所欲为",可以自由的[使用](https://baike.baidu.com/item/使用)，修改源代码，也可以将修改后的代码作为开源或者专有软件再发布。但"为所欲为"的前提是当你发布使用了BSD协议的代码，或者以BSD协议代码为基础做二次开发自己的产品时，需要满足三个条件：1.如果再发布的产品中包含[源代码](https://baike.baidu.com/item/源代码)，则在源代码中必须带有原来代码中的BSD协议。2.如果再发布的只是二进制类库/软件，则需要在类库/软件的文档和版权声明中包含原来代码中的BSD协议。3.不可以用开源代码的作者/机构名字和原来产品的名字做市场推广。 



RFC793我没找到具体描述，中文文档全都要钱，呜呜呜，就放个英文的链接吧

RFC793英文原版：https://blog.csdn.net/qq_39661959/article/details/112068434

